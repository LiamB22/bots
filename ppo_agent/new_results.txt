rep_and_models = {
    "vector":["mlp_ppo"], # "0" vector only models. model 0, 1, 2.. etc
    "mixed":["combined_ppo"] # "1" mixed only models. model 0, 1, 2.. etc
    }
map_types = {0:"base", 1:"mini", 2:"tournament"}
enemy_types = {"W":0,"AB":1,"MCTS":2,"VF":3,"MIX":4} # AB uses a default depth of 2
rewards = {"win":100, "lose":-100, "l_positive":1, "s_positive":0.01, "s_negative":-0.01, "move_penalty":-0.5,"none":0, 
           "current_vp":0.2, "longest_road_length":0.005, "roads_left":0.01, "settlements_left":0.01, "cities_left":0.03,
           "played_dev_card":0.1, "has_largest_army":0.2, "has_longest_road":0.2}
enemy_type = enemy_types["W"] #change enemy
map_type = map_types[1] #change map
vps_to_win = 6 #chane number of victory points required to win
num_enemies = 3 #change the number of enemy bots
eval_episodes = 1_000 #change how many episodes the agent is evaluated for

model = MaskablePPO(
            MaskableActorCriticPolicy,
            env,
            policy_kwargs=policy_kwargs,
            verbose=1,
            learning_rate=1e-4,
            # learning_rate=linear_schedule,
            n_steps=2048, # experience before update
            batch_size=128, # size of minibatches creates n_steps/batch_size mini-batches
            n_epochs=15, # number of times we use n_steps (num games)
            gamma=0.995, # discount factor
            gae_lambda=0.95, # generalising advantage estimation
            clip_range=0.2,
            clip_range_vf=None,
            ent_coef=0.01, # encourages exploration by adding entropy bonus to the loss
            vf_coef=0.5, # weight of value function loss relative to policy loss
            max_grad_norm=0.1, # clips gradient to prevent exploding gradient problem
            tensorboard_log=log_dir, # log training for later viewing
        )

COMBINED ==================================================
125 000 time steps:

combined_ppo run 1:
Win Rate: 43.30%
Average Reward: 2.53
Wins: 433, Losses: 567
Min/Max Reward: -107.81/180.51
total evaluation time: 363.491634 seconds

run 2:
Win Rate: 41.80%
Average Reward: 1.09
Wins: 418, Losses: 582
Min/Max Reward: -107.42/224.33
total evaluation time: 379.738774 seconds

run 3:
Win Rate: 36.80%
Average Reward: -10.21
Wins: 368, Losses: 632
Min/Max Reward: -105.74/203.72
total evaluation time: 348.777534 seconds

run 4:
Win Rate: 40.10%
Average Reward: -3.26
Wins: 401, Losses: 599
Min/Max Reward: -108.83/211.79
total evaluation time: 346.185365 seconds

run 5:
Win Rate: 26.00%
Average Reward: -35.69
Wins: 260, Losses: 740
Min/Max Reward: -110.26/225.03
total evaluation time: 354.928537 seconds

250 000 time steps:

combined_ppo run 1:
Win Rate: 32.40%
Average Reward: -21.28
Wins: 324, Losses: 676
Min/Max Reward: -111.78/273.25
total evaluation time: 343.941228 seconds

run 2:
Win Rate: 46.40%
Average Reward: 9.96
Wins: 464, Losses: 536
Min/Max Reward: -106.52/206.72
total evaluation time: 336.411470 seconds

run 3:
Win Rate: 43.40%
Average Reward: 3.61
Wins: 434, Losses: 566
Min/Max Reward: -108.78/189.56
total evaluation time: 334.617252 seconds

run 4:
Win Rate: 43.60%
Average Reward: 4.56
Wins: 436, Losses: 564
Min/Max Reward: -110.18/237.33
total evaluation time: 338.886060 seconds

run 5:
Win Rate: 43.50%
Average Reward: 4.07
Wins: 435, Losses: 565
Min/Max Reward: -106.62/212.64
total evaluation time: 338.484939 seconds

500 000 time steps:

combined_ppo run 1:
Win Rate: 47.70%
Average Reward: 15.07
Wins: 477, Losses: 523
Min/Max Reward: -106.17/247.54
total evaluation time: 336.689877 seconds

run 2:
Win Rate: 51.70%
Average Reward: 21.00
Wins: 517, Losses: 483
Min/Max Reward: -108.07/243.75
total evaluation time: 334.647937 seconds

run 3:
Win Rate: 47.70%
Average Reward: 15.17
Wins: 477, Losses: 523
Min/Max Reward: -108.07/220.85
total evaluation time: 344.087929 seconds

run 4:
Win Rate: 44.60%
Average Reward: 5.55
Wins: 446, Losses: 554
Min/Max Reward: -107.47/213.57
total evaluation time: 338.124829 seconds

run 5:
Win Rate: 33.60%
Average Reward: -19.02
Wins: 336, Losses: 664
Min/Max Reward: -120.81/199.65
total evaluation time: 363.496868 seconds

1 000 000 time steps:

combined_ppo run 1:
Win Rate: 58.50%
Average Reward: 37.41
Wins: 585, Losses: 415
Min/Max Reward: -105.09/225.52
total evaluation time: 23695.695193 seconds

run 2:
Win Rate: 53.80%
Average Reward: 26.97
Wins: 538, Losses: 462
Min/Max Reward: -108.98/224.63
total evaluation time: 307.414432 seconds

run 3:
Win Rate: 50.40%
Average Reward: 20.38
Wins: 504, Losses: 496
Min/Max Reward: -109.91/225.67
total evaluation time: 363.834355 seconds

run 4:
Win Rate: 51.40%
Average Reward: 21.76
Wins: 514, Losses: 486
Min/Max Reward: -107.80/217.76
total evaluation time: 325.824675 seconds

run 5:
Win Rate: 55.90%
Average Reward: 31.18
Wins: 559, Losses: 441
Min/Max Reward: -106.77/267.01
total evaluation time: 308.688925 seconds

combined with sparse rewards:

125 000 time steps:

run 1:
Win Rate: 41.30%
Average Reward: -17.40
Wins: 413, Losses: 587
Min/Max Reward: -100.00/100.00
total evaluation time: 359.272851 seconds

run 2:
Win Rate: 46.80%
Average Reward: -6.40
Wins: 468, Losses: 532
Min/Max Reward: -100.00/100.00
total evaluation time: 367.502992 seconds

run 3:
Win Rate: 32.50%
Average Reward: -35.00
Wins: 325, Losses: 675
Min/Max Reward: -100.00/100.00
total evaluation time: 370.034611 seconds

run 4:
Win Rate: 44.00%
Average Reward: -12.00
Wins: 440, Losses: 560
Min/Max Reward: -100.00/100.00
total evaluation time: 335.951019 seconds

run 5:
Win Rate: 32.80%
Average Reward: -34.40
Wins: 328, Losses: 672
Min/Max Reward: -100.00/100.00
total evaluation time: 351.670618 seconds

250 000 time steps:

run 1:
Win Rate: 41.10%
Average Reward: -17.80
Wins: 411, Losses: 589
Min/Max Reward: -100.00/100.00
total evaluation time: 384.009883 seconds

run 2:
Win Rate: 38.60%
Average Reward: -22.80
Wins: 386, Losses: 614
Min/Max Reward: -100.00/100.00
total evaluation time: 377.198425 seconds

run 3:
Win Rate: 36.00%
Average Reward: -28.00
Wins: 360, Losses: 640
Min/Max Reward: -100.00/100.00
total evaluation time: 442.571934 seconds

run 4:
Win Rate: 41.90%
Average Reward: -16.20
Wins: 419, Losses: 581
Min/Max Reward: -100.00/100.00
total evaluation time: 420.288904 seconds

run 5:
Win Rate: 40.10%
Average Reward: -19.80
Wins: 401, Losses: 599
Min/Max Reward: -100.00/100.00
total evaluation time: 377.576838 seconds

500 000 time steps:

run 1:


run 2:


run 3:


run 4:


run 5:

1 000 000 time steps:

run 1:
Win Rate: 54.60%
Average Reward: 9.20
Wins: 546, Losses: 454
Min/Max Reward: -100.00/100.00
total evaluation time: 407.823350 seconds

run 2:
Win Rate: 54.00%
Average Reward: 8.00
Wins: 540, Losses: 460
Min/Max Reward: -100.00/100.00
total evaluation time: 354.562216 seconds

run 3:
Win Rate: 57.70%
Average Reward: 15.40
Wins: 577, Losses: 423
Min/Max Reward: -100.00/100.00
total evaluation time: 295.539402 seconds

run 4:
Win Rate: 50.30%
Average Reward: 0.60
Wins: 503, Losses: 497
Min/Max Reward: -100.00/100.00
total evaluation time: 319.248784 seconds

run 5:
Win Rate: 51.90%
Average Reward: 3.80
Wins: 519, Losses: 481
Min/Max Reward: -100.00/100.00
total evaluation time: 305.736852 seconds


MLP ==================================================
125 000 time steps:

mlp_ppo run 1:
Win Rate: 43.80%
Average Reward: 5.61
Wins: 438, Losses: 562
Min/Max Reward: -109.41/205.01
total evaluation time: 209.317295 seconds

run 2:
Win Rate: 43.30%
Average Reward: 5.89
Wins: 433, Losses: 567
Min/Max Reward: -107.53/225.54
total evaluation time: 207.278473 seconds

run 3:
Win Rate: 45.00%
Average Reward: 7.13
Wins: 450, Losses: 550
Min/Max Reward: -105.76/211.24
total evaluation time: 195.969641 seconds

run 4:
Win Rate: 48.90%
Average Reward: 15.33
Wins: 489, Losses: 511
Min/Max Reward: -106.40/225.61
total evaluation time: 185.677346 seconds

run 5:
Win Rate: 26.80%
Average Reward: -30.91
Wins: 268, Losses: 732
Min/Max Reward: -107.06/267.37
total evaluation time: 210.762035 seconds

250 000 time steps:

mlp_ppo run 1:
Win Rate: 49.90%
Average Reward: 16.09
Wins: 499, Losses: 501
Min/Max Reward: -106.89/209.58
total evaluation time: 189.897614 seconds

run 2:
Win Rate: 45.80%
Average Reward: 8.29
Wins: 458, Losses: 542
Min/Max Reward: -108.36/195.59
total evaluation time: 192.026174 seconds

run 3:
Win Rate: 38.30%
Average Reward: -6.44
Wins: 383, Losses: 617
Min/Max Reward: -108.66/217.15
total evaluation time: 210.426384 seconds

run 4:
Win Rate: 43.50%
Average Reward: 0.50
Wins: 435, Losses: 565
Min/Max Reward: -110.25/254.12
total evaluation time: 204.354629 seconds

run 5:
Win Rate: 47.10%
Average Reward: 11.25
Wins: 471, Losses: 529
Min/Max Reward: -107.19/199.11
total evaluation time: 211.208973 seconds

500 000 time steps:

mlp_ppo run 1:
Win Rate: 45.00%
Average Reward: 7.90
Wins: 450, Losses: 550
Min/Max Reward: -105.67/190.85
total evaluation time: 195.108275 seconds

run 2:
Win Rate: 43.60%
Average Reward: 3.80
Wins: 436, Losses: 564
Min/Max Reward: -105.70/218.75
total evaluation time: 193.241598 seconds

run 3:
Win Rate: 45.30%
Average Reward: 8.07
Wins: 453, Losses: 547
Min/Max Reward: -109.71/232.80
total evaluation time: 190.590546 seconds

run 4:
Win Rate: 46.90%
Average Reward: 8.05
Wins: 469, Losses: 531
Min/Max Reward: -112.78/198.49
total evaluation time: 193.378223 seconds

run 5:
Win Rate: 50.90%
Average Reward: 18.60
Wins: 509, Losses: 491
Min/Max Reward: -107.82/232.01
total evaluation time: 186.811148 seconds

1 000 000 time steps:

mlp_ppo run 1:
Win Rate: 49.70%
Average Reward: 16.88
Wins: 497, Losses: 503
Min/Max Reward: -109.19/216.06
total evaluation time: 182.208979 seconds

run 2:
Win Rate: 50.80%
Average Reward: 19.80
Wins: 508, Losses: 492
Min/Max Reward: -109.74/209.04
total evaluation time: 180.200869 seconds

run 3:
Win Rate: 52.60%
Average Reward: 22.03
Wins: 526, Losses: 474
Min/Max Reward: -106.02/200.28
total evaluation time: 176.695387 seconds

run 4:
Win Rate: 56.60%
Average Reward: 30.16
Wins: 566, Losses: 434
Min/Max Reward: -105.44/202.45
total evaluation time: 174.665650 seconds

run 5:
Win Rate: 46.90%
Average Reward: 11.08
Wins: 469, Losses: 531
Min/Max Reward: -107.54/190.20
total evaluation time: 188.773321 seconds

mlp_ppo with sparse rewards:

125 000 time steps:

run 1:
Win Rate: 37.40%
Average Reward: -25.20
Wins: 374, Losses: 626
Min/Max Reward: -100.00/100.00
total evaluation time: 205.090896 seconds

run 2:
Win Rate: 41.00%
Average Reward: -18.00
Wins: 410, Losses: 590
Min/Max Reward: -100.00/100.00
total evaluation time: 203.591290 seconds

run 3:
Win Rate: 44.40%
Average Reward: -11.20
Wins: 444, Losses: 556
Min/Max Reward: -100.00/100.00
total evaluation time: 192.292544 seconds

run 4:
Win Rate: 32.20%
Average Reward: -35.60
Wins: 322, Losses: 678
Min/Max Reward: -100.00/100.00
total evaluation time: 218.645669 seconds

run 5:
Win Rate: 44.80%
Average Reward: -10.40
Wins: 448, Losses: 552
Min/Max Reward: -100.00/100.00
total evaluation time: 198.838987 seconds

250 000 time steps:

run 1:
Win Rate: 48.80%
Average Reward: -2.40
Wins: 488, Losses: 512
Min/Max Reward: -100.00/100.00
total evaluation time: 193.616989 seconds

run 2:
Win Rate: 45.00%
Average Reward: -10.00
Wins: 450, Losses: 550
Min/Max Reward: -100.00/100.00
total evaluation time: 194.767581 seconds

run 3:
Win Rate: 49.90%
Average Reward: -0.20
Wins: 499, Losses: 501
Min/Max Reward: -100.00/100.00
total evaluation time: 189.989083 seconds

run 4:
Win Rate: 46.50%
Average Reward: -7.00
Wins: 465, Losses: 535
Min/Max Reward: -100.00/100.00
total evaluation time: 189.130867 seconds

run 5:
Win Rate: 47.00%
Average Reward: -6.00
Wins: 470, Losses: 530
Min/Max Reward: -100.00/100.00
total evaluation time: 186.207506 seconds

500 000 time steps:

run 1:


run 2:


run 3:


run 4:


run 5:

1 000 000 time steps:

run 1:
Win Rate: 51.50%
Average Reward: 3.00
Wins: 515, Losses: 485
Min/Max Reward: -100.00/100.00
total evaluation time: 187.638657 seconds

run 2:
Win Rate: 53.50%
Average Reward: 7.00
Wins: 535, Losses: 465
Min/Max Reward: -100.00/100.00
total evaluation time: 181.150192 seconds

run 3:
Win Rate: 47.50%
Average Reward: -5.00
Wins: 475, Losses: 525
Min/Max Reward: -100.00/100.00
total evaluation time: 185.426757 seconds

run 4:
Win Rate: 46.80%
Average Reward: -6.40
Wins: 468, Losses: 532
Min/Max Reward: -100.00/100.00
total evaluation time: 185.445342 seconds

run 5:
Win Rate: 53.80%
Average Reward: 7.60
Wins: 538, Losses: 462
Min/Max Reward: -100.00/100.00
total evaluation time: 181.956277 seconds






combined model but
changed
nn.AdaptiveAvgPool2d((3, 2)),  # Fixed output size
to
nn.AdaptiveAvgPool2d((6, 4)),  # Increased output spatial size (height x width)
Evaluation Results:
Win Rate: 51.50%
Average Reward: 20.94
Wins: 515, Losses: 485
Min/Max Reward: -107.55/199.36
total evaluation time: 321.486890 seconds

